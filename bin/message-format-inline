#!/usr/bin/env node

var
	readFileSync = require('fs').readFileSync,
	writeFileSync = require('fs').writeFileSync,
	glob = require('glob'),
	Inliner = require('../dist/inliner')

function transformFile(sourceFileName) {
	var
		sourceCode = readFileSync(sourceFileName, 'utf8'),
		result = Inliner.inline({ sourceCode:sourceCode, sourceFileName:sourceFileName }),
		destCode = result.code +
			'\n//# sourceMappingURL=data:application/json;base64,' +
			new Buffer(result.map.toString()).toString('base64')
//	writeFileSync(destFileName, destCode, 'utf8')
	process.stdout.write(destCode)
}

var files = glob.sync(process.argv[2])
files.forEach(transformFile)

